---
title: "Adults 6-0-0/5-1-0 overview"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(ggplot2)
library(jsonlite)
library(tidyr)
library(stringr)
library(dplyr)
library(ggthemes)
library(langcog)
library(lsr)
```

Here we compare data from the 6-0-0 distribution in four different conditions. 
*"it" - At test, animal asks: "Can you click on it?".
*"it - name categories" - same as "it" but participants read the names of the categories that will feature in the game as part of the introduction.
*"it - show categories" - same as "it" but participants see all pictures that will feature in the game grouped by category as part of the introduction.
*"mumble" - At test, animal asks: "Can you click on the [mumble mumble]?". Participants are told that animals sometimes mumble during the introdcution.

```{r importing data, include=F}

# data for differetn intros

intros <- read_csv(file="../data/adult_intros.data.csv")

drop_intros <- intros %>%
  filter(phase == 'training') %>%
  group_by(workerid) %>%
  summarise(correct = mean(correct_item)) %>%
  filter(correct < 0.83) %>%
  pull(workerid)

intros <- intros  %>%
  filter(!workerid %in% drop_intros)%>%
  mutate(experiment = recode(experiment,
                             "distribution_adults_name" = "it - name categories",
                             "distribution_adults_visual" = "it - show categories",
                             "distribution_adults" = "it"))
# mumble data

 mumble <- read_csv(file="../data/01_adult_mumble_data.csv")%>%
   mutate(experiment = "mumble")

# filter out children that don't get known words right
drop_mumble <- mumble %>%
  filter(phase == 'training') %>%
  group_by(workerid) %>%
  summarise(correct = mean(correct_item)) %>%
  filter(correct < 0.83) %>%
  pull(workerid)

mumble <- mumble  %>%
  filter(!workerid %in% drop_mumble)


# data for 510

d510 <- read_csv(file="../data/01_pilot_summary_recency.data.csv") %>%
  filter(distribution == "c(5, 1, 0)")

### combining datasets

data <- bind_rows(
  mumble,
  intros
)

```

# Correct choice by experiment
```{r, echo = F}
plot1 <- data %>%
  filter(phase != "training")%>%
  group_by(experiment,workerid)%>%
  summarise(correct = mean(correct_target1))

plot2 <-plot1 %>%
  multi_boot_standard(col = "correct")

ggplot() +
  geom_jitter(data = plot1, aes(x = experiment, y = correct, col = experiment, alpha = .2), width = .3,height = .01)+
  geom_pointrange(data = plot2, aes(x = experiment, y = mean, col = experiment, ymin = ci_lower, ymax = ci_upper),size = .8)+
  #facet_grid(~distribution)+
  geom_hline(yintercept = 1/3, lty=2)+
  labs(x="Experiment", y="Proportion Correct")+
  theme_few() +
  ylim(-0.05,1.05)+
  guides(alpha = F, col = F) 
  #theme(axis.text.x=element_blank(),axis.ticks.x=element_blank())
```

# Bayesian t-tests for each condition
```{r}

library(BayesianFirstAid)

data %>%
  filter(phase != "training") %>%
  group_by(experiment, workerid) %>%
  summarise(correct = mean(correct_target1)) %>%
  summarise(correct = list(correct)) %>%
  group_by(experiment) %>%
  mutate(mu = bayes.t.test(unlist(correct), mu = 1/3)$stats[1,1],
         HDIlo = bayes.t.test(unlist(correct), mu = 1/3)$stats[1,5],
         HDIup = bayes.t.test(unlist(correct), mu = 1/3)$stats[1,6],
         eff.size = bayes.t.test(unlist(correct), mu = 1/3)$stats[4,1]) %>%
  select(mu,HDIlo,HDIup,eff.size)


```


# Correct choice by experiment and category
```{r}
plot3 <- data %>%
  filter(phase != "training")%>%
  group_by(experiment,target1, workerid)%>%
  summarise(correct = mean(correct_target1))%>%
  multi_boot_standard(col = "correct")

ggplot() +
  geom_pointrange(data = plot3, aes(x = target1, y = mean, col = experiment, ymin = ci_lower, ymax = ci_upper),size = .8)+
  facet_grid(experiment~.)+
  geom_hline(yintercept = 1/3, lty=2)+
  labs(x="Target Category", y="Proportion Correct")+
  theme_few() +
  ylim(-0.05,1.05)+
  guides(alpha = F, col = F) 
  #theme(axis.text.x=element_blank(),axis.ticks.x=element_blank())
```


# Correct chioce by experiment and trial
```{r}
plot4 <- data %>%
  filter(phase != "training")%>%
  group_by(experiment,trial, workerid)%>%
  summarise(correct = mean(correct_target1))%>%
  multi_boot_standard(col = "correct")

ggplot(data = plot4,aes(x = trial, y = mean, col = experiment)) +
  geom_pointrange(aes(ymin = ci_lower, ymax = ci_upper))+
  #facet_grid(experiment~.)+
  geom_line(aes(group = experiment)) + 
  geom_hline(yintercept = 1/3, lty=2)+
  labs(x="Trial", y="Proportion Correct")+
  theme_few() +
  ylim(-0.05,1.05)+
  guides(alpha = F) 
  #theme(axis.text.x=element_blank(),axis.ticks.x=element_blank())
```

# Test to see if the most recent is picked: 510 distribution

Here the last item was always from a different category
```{r}
plot5 <- d510 %>%
  filter(phase != "training", 
         experiment == "recency_look")%>%
  group_by(experiment,workerid)%>%
  summarise(correct = mean(correct_target1))

plot6 <-plot5 %>%
  multi_boot_standard(col = "correct")

ggplot() +
  geom_jitter(data = plot5, aes(x = experiment, y = correct, col = experiment, alpha = .2), width = .3,height = .01)+
  geom_pointrange(data = plot6, aes(x = experiment, y = mean, col = experiment, ymin = ci_lower, ymax = ci_upper),size = .8)+
  #facet_grid(~distribution)+
  geom_hline(yintercept = 1/3, lty=2)+
  labs(x="Experiment", y="Proportion Correct")+
  theme_few() +
  ylim(-0.05,1.05)+
  guides(alpha = F, col = F) 
  #theme(axis.text.x=element_blank(),axis.ticks.x=element_blank())



```

```{r}
d510 %>%
  filter(phase != "training") %>%
  group_by(experiment, workerid) %>%
  summarise(correct = mean(correct_target1)) %>%
  summarise(correct = list(correct)) %>%
  group_by(experiment) %>%
  mutate(mu = bayes.t.test(unlist(correct), mu = 1/3)$stats[1,1],
         HDIlo = bayes.t.test(unlist(correct), mu = 1/3)$stats[1,5],
         HDIup = bayes.t.test(unlist(correct), mu = 1/3)$stats[1,6],
         eff.size = bayes.t.test(unlist(correct), mu = 1/3)$stats[4,1]) %>%
  select(mu,HDIlo,HDIup,eff.size)
```

